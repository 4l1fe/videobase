doctype html
html
    include config
    include mixins

    - console.log(cast)

    - film_name_meta = cast.title.replace(/"/g, " ")
    - film_descr_meta = cast.description ? cast.description.replace(/"/g, ' ').substr(0,256) : ''
    - film_url_meta = 'http://vsevi.ru/films/' + cast.id
    - film_img_meta = cast.poster || noposter_url
    - if (film_img_meta[0] == "/") film_img_meta = 'http://vsevi.ru' + film_img_meta
    - title_alt = cast.title
    - if (cast.title_orig && cast.title_orig != cast.title) title_alt+= " (" + cast.title_orig + ")"
    - page_title_full = title_alt + " &mdash; фильмы на Все видео"
    - page_keywords = "фильм " + cast.title + (cast.title_orig?": " + cast.title_orig:"") + " онлайн-просмотр высокое качество смотреть онлайн рекомендации все видео dvdrip hd"
    - page_description = "Онлайн просмотр без регистрации и информация о фильме " + cast.title + (cast.title_orig?" (" + cast.title_orig + ")":"") + " рецензии, комментарии, рейтинг, русский трейлер, рекомендации к просмотру."
    - meta = ['property="og:title" content="' + film_name_meta + '"', 'property="og:url" content="' + film_url_meta + '"', 'property="og:description" content="' + film_descr_meta + '"', 'property="og:image" content="' + film_img_meta + '"']
    - meta.push('name="twitter:card" content="summary"')
    - meta.push('name="twitter:url" content="' + film_url_meta + '"')
    - meta.push('name="twitter:title" content="' + film_name_meta + '"')
    - meta.push('name="twitter:description" content="' + film_descr_meta + '"')
    - meta.push('name="twitter:image" content="' + film_img_meta + '"')
    - head_link = ['rel="canonical" href="http://vsevi.ru/films/' + cast.id + '/"']
    - if (cast.releasedate) title_alt+= " " + cast.releasedate.substr(0,4)
    - social_networks = [{ img: "/static/img/i-vk.png", href: "http://vk.com/vsevi", title:"Страница ВсеВидео в Вконтакте" }]
    - social_networks.push({ img: "/static/img/i-ok.png", href: "http://www.odnoklassniki.ru/group/53196730400877", title:"Страница ВсеВидео в Одноклассниках" })
    - social_networks.push({ img: "/static/img/i-tw.png", href: "https://twitter.com/vseviru", title:"Страница ВсеВидео в Твиттере" })
    - social_networks.push({ img: "/static/img/i-fb.png", href: "https://www.facebook.com/vseviru", title:"Страница ВсеВидео в Фейсбуке" })

    include head
    body
        .wrap-page.bg-noise
            include header
            .content(role='main')
                - if (cast.locations && cast.locations.length) {
                    section.broun-block-playlist
                        .bg-noise
                            .title-cast
                                .container
                                    .row
                                        .col-md-8.col-sm-7
                                            .name-playlist
                                                h2=cast.title
                                                if cast.title_orig && cast.title_orig != cast.title
                                                    span=cast.title_orig
                                        .col-md-4.col-sm-5
                                            .share-block.fright
                                                script(src="http://yandex.st/share/share.js", charset="utf-8")
                                                .yashare-auto-init(data-yasharetype="big", data-yashareL10n="ru", data-yashareQuickServices="vkontakte,odnoklassniki,moimir,facebook,twitter,gplus", data-yashareTheme="counter")


                            //-
                               .title-cast
                            .cast-area
                                .container
                                    each el in cast.locations
                                        a(id=el.id)
                                    a(id="player")
                                    .frame-player-wrapper
                                        .frame-player-aspect
                                            .frame-player#frame_player
                                    if cast.locations.length > 1
                                        ul.just-list.list-btns-film#locations
                                            each el in cast.locations
                                                mixin loc_thumb(el)
                            //-
                               .cast-area
                    //-
                        .broun-block
                - }
            section.brd-top
                .container
                    if cast.description
                        .cast-description-block
                            h2.blackh1=cast.title
                            p!=cast.description

            - cast_chat_items = [{user: {name: "Василий Пупкин", avatar:""}, text: "Довольно неплохая передача, если учесть, кто ее авторы", created: new Date(0,0,0, 12, 31, 0)}]
            - cast_chat_items.push({user: {name: "Гоблин Вася", avatar:""}, text: "По-моему основная тема так и не была раскрыта, хотя вопрос очень важный", created: new Date(0,0,0, 14, 21, 0)})
            - cast_chat_items.push({user: {name: "Владимир Владимирович", avatar:""}, text: "Общественное мнение по этому вопросу очень важно, поэтому необходимо продолжать подобные обсуждения", created: new Date(0,0,0, 1, 18, 0)})
            - cast_chat_items.push({user: {name: "Афанасий Прокопьевич", avatar:""}, text: "Моральная сторона этого вопроса тоже должна обсуждаться, а не только правовая его часть!", created: new Date(0,0,0, 19, 08, 0)})
            section.brd-top.cast-chat
                .container
                    h2.blackh1 Чат
                    .cast-chat-item-list
                        each chat_item in cast_chat_items
                            .cast-chat-item
                                span.cast-chat-user-avatar
                                    - avatar_url = (chat_item.user.avatar && chat_item.user.avatar.length) ? chat_item.user.avatar : noavatar_url
                                    img(src=avatar_url).img-circle
                                .cast-chat-item-body
                                    span.cast-chat-item-created
                                        - msg_created_minutes = ( chat_item.created.getMinutes() < 10 ? '0' : '' ) + chat_item.created.getMinutes()
                                        - chat_msg_created = '[' + chat_item.created.getHours() + ':' + msg_created_minutes + ']'
                                        =chat_msg_created
                                    | #{" "}
                                    span.cast-chat-item-username=chat_item.user.name
                                        | :
                                    div.cast-chat-item-msg=chat_item.text
                    textarea.cast-chat-text-area
                    .cast-chat-btn-submit
                        a(href="#") Отправить


            if online_casts && online_casts.length
                section.brd-top
                    .container
                        h1.dots2.blackh1.centerh1 Онлайн трансляции
                        mixin casts_list(online_casts)

            include footer
            //- delete(film.similar); delete(film.description); delete(film.trailer);
            //- delete(film.comments);
            script.
                $(document).ready(function () {window.InitApp({page_conf: !{JSON.stringify(film)}}, "Film")})